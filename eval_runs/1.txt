(env) tamaghnadutta@Tamaghnas-MacBook-Air meraki_labs % make eval
python scripts/run_eval.py
/Users/tamaghnadutta/Downloads/meraki_labs/env/lib/python3.10/site-packages/pydantic/_internal/_generate_schema.py:404: UserWarning: <built-in function any> is not a Python type (it may be an instance of an object), Pydantic will allow any object with no validation since we cannot even enforce that the input is an instance of the given type. To get rid of this error wrap the type with `pydantic.SkipValidation`.
  warn(
2025-09-13 12:46:25 - __main__ - INFO - Starting evaluation harness with real data
2025-09-13 12:46:25 - src.data.dataset - INFO - Loaded 4 samples from dataset
2025-09-13 12:46:25 - __main__ - INFO - Evaluating baseline model (OCR+LLM)
2025-09-13 12:46:25 - src.models.gemini_processor - INFO - Initialized Gemini client successfully
2025-09-13 12:46:25 - src.models.error_detector - INFO - Initialized ErrorDetector with Gemini 2.5 Flash
2025-09-13 12:46:25 - src.eval.evaluator - INFO - Starting evaluation of baseline_ocr_llm
2025-09-13 12:46:25 - root - INFO - AFC is enabled with max remote calls: 10.
2025-09-13 12:46:25 - root - INFO - AFC is enabled with max remote calls: 10.
2025-09-13 12:46:33 - root - INFO - AFC is enabled with max remote calls: 10.
2025-09-13 12:46:34 - root - INFO - AFC is enabled with max remote calls: 10.
2025-09-13 12:46:46 - src.models.gemini_processor - INFO - OCR completed successfully in 12.91s
2025-09-13 12:46:46 - root - INFO - AFC is enabled with max remote calls: 10.
2025-09-13 12:46:51 - src.models.gemini_processor - INFO - OCR completed successfully in 17.45s
2025-09-13 12:46:51 - root - INFO - AFC is enabled with max remote calls: 10.
2025-09-13 12:46:58 - src.models.gemini_processor - INFO - Comprehensive error detection completed in 32.59s
2025-09-13 12:46:58 - src.models.error_detector - INFO - Gemini error detection completed: has_error=True, confidence=0.950, duration=32.66s
2025-09-13 12:46:58 - root - INFO - AFC is enabled with max remote calls: 10.
2025-09-13 12:47:02 - src.models.gemini_processor - INFO - Comprehensive error detection completed in 36.59s
2025-09-13 12:47:02 - src.models.error_detector - INFO - Gemini error detection completed: has_error=False, confidence=0.950, duration=36.66s
2025-09-13 12:47:02 - root - INFO - AFC is enabled with max remote calls: 10.
2025-09-13 12:47:06 - root - INFO - AFC is enabled with max remote calls: 10.
2025-09-13 12:47:15 - root - INFO - AFC is enabled with max remote calls: 10.
2025-09-13 12:47:22 - src.models.gemini_processor - INFO - OCR completed successfully in 15.67s
2025-09-13 12:47:22 - root - INFO - AFC is enabled with max remote calls: 10.
2025-09-13 12:48:29 - src.models.gemini_processor - INFO - OCR completed successfully in 74.15s
2025-09-13 12:48:29 - root - INFO - AFC is enabled with max remote calls: 10.
2025-09-13 12:48:32 - src.models.gemini_processor - INFO - Comprehensive error detection completed in 94.07s
2025-09-13 12:48:32 - src.models.error_detector - INFO - Gemini error detection completed: has_error=True, confidence=0.950, duration=94.10s
2025-09-13 12:48:38 - src.models.gemini_processor - INFO - Comprehensive error detection completed in 96.68s
2025-09-13 12:48:38 - src.models.error_detector - INFO - Gemini error detection completed: has_error=True, confidence=0.950, duration=96.71s
2025-09-13 12:48:38 - src.eval.evaluator - INFO - Evaluation completed for baseline_ocr_llm: accuracy=1.000, latency_p95=96.71s
2025-09-13 12:48:38 - __main__ - INFO - Evaluating improved model (Hybrid)
2025-09-13 12:48:38 - src.models.gemini_processor - INFO - Initialized Gemini client successfully
2025-09-13 12:48:38 - src.models.error_detector - INFO - Initialized ErrorDetector with Gemini 2.5 Flash
2025-09-13 12:48:38 - src.eval.evaluator - INFO - Starting evaluation of improved_hybrid
2025-09-13 12:48:38 - root - INFO - AFC is enabled with max remote calls: 10.
2025-09-13 12:48:38 - root - INFO - AFC is enabled with max remote calls: 10.
2025-09-13 12:48:44 - root - INFO - AFC is enabled with max remote calls: 10.
2025-09-13 12:48:48 - root - INFO - AFC is enabled with max remote calls: 10.
2025-09-13 12:48:55 - src.models.gemini_processor - INFO - OCR completed successfully in 11.63s
2025-09-13 12:48:55 - root - INFO - AFC is enabled with max remote calls: 10.
2025-09-13 12:49:05 - src.models.gemini_processor - INFO - OCR completed successfully in 16.79s
2025-09-13 12:49:05 - root - INFO - AFC is enabled with max remote calls: 10.
2025-09-13 12:49:15 - src.models.gemini_processor - INFO - Comprehensive error detection completed in 36.83s
2025-09-13 12:49:15 - src.models.error_detector - INFO - Gemini error detection completed: has_error=True, confidence=0.950, duration=36.86s
2025-09-13 12:49:15 - root - INFO - AFC is enabled with max remote calls: 10.
2025-09-13 12:49:19 - src.models.gemini_processor - INFO - Comprehensive error detection completed in 40.58s
2025-09-13 12:49:19 - src.models.error_detector - INFO - Gemini error detection completed: has_error=False, confidence=0.950, duration=40.61s
2025-09-13 12:49:19 - root - INFO - AFC is enabled with max remote calls: 10.
2025-09-13 12:49:21 - root - INFO - AFC is enabled with max remote calls: 10.
2025-09-13 12:49:32 - root - INFO - AFC is enabled with max remote calls: 10.
2025-09-13 12:49:43 - src.models.gemini_processor - INFO - OCR completed successfully in 21.82s
2025-09-13 12:49:43 - root - INFO - AFC is enabled with max remote calls: 10.
2025-09-13 12:49:53 - src.models.gemini_processor - INFO - Comprehensive error detection completed in 37.50s
2025-09-13 12:49:53 - src.models.error_detector - INFO - Gemini error detection completed: has_error=True, confidence=0.950, duration=37.53s
2025-09-13 12:49:54 - src.models.gemini_processor - INFO - OCR completed successfully in 22.12s
2025-09-13 12:49:54 - root - INFO - AFC is enabled with max remote calls: 10.
2025-09-13 12:50:03 - src.models.gemini_processor - INFO - Comprehensive error detection completed in 43.58s
2025-09-13 12:50:03 - src.models.error_detector - INFO - Gemini error detection completed: has_error=True, confidence=0.900, duration=43.61s
2025-09-13 12:50:03 - src.eval.evaluator - INFO - Evaluation completed for improved_hybrid: accuracy=1.000, latency_p95=43.61s
2025-09-13 12:50:03 - __main__ - INFO - Results saved to ./data/eval_results/evaluation_results.json

================================================================================
ERROR DETECTION API - EVALUATION RESULTS
================================================================================

Core Performance Metrics:
+----------------------+----------------------+---------------------+---------------+
| Metric               |   Baseline (OCR+LLM) |   Improved (Hybrid) | Improvement   |
+======================+======================+=====================+===============+
| Accuracy             |                1     |               1     | +0.000        |
+----------------------+----------------------+---------------------+---------------+
| F1 Score             |                1     |               1     | +0.000        |
+----------------------+----------------------+---------------------+---------------+
| Step-Level Accuracy  |                0.704 |               0.704 | +0.000        |
+----------------------+----------------------+---------------------+---------------+
| Error Detection Rate |                1     |               1     | N/A           |
+----------------------+----------------------+---------------------+---------------+

Latency Metrics (seconds):
+--------------+------------+------------+---------------+
| Percentile   |   Baseline |   Improved |   Improvement |
+==============+============+============+===============+
| p50          |      94.11 |      40.61 |          53.5 |
+--------------+------------+------------+---------------+
| p90          |      96.71 |      43.61 |          53.1 |
+--------------+------------+------------+---------------+
| p95          |      96.71 |      43.61 |          53.1 |
+--------------+------------+------------+---------------+

Cost Estimation (per 100 requests):
+--------------------+------------------+---------------------------------------------+
| Model              | Estimated Cost   | Notes                                       |
+====================+==================+=============================================+
| Baseline (OCR+LLM) | $0.60            | Gemini 2.5 Flash (thinking_budget=0)        |
+--------------------+------------------+---------------------------------------------+
| Improved (Hybrid)  | $0.60            | Gemini 2.5 Flash Vision (thinking_budget=0) |
+--------------------+------------------+---------------------------------------------+

================================================================================
2025-09-13 12:50:03 - __main__ - INFO - Evaluation completed successfully