(env) tamaghnadutta@Tamaghnas-MacBook-Air tutor-vision-engine % make demo
python scripts/demo.py
/Users/tamaghnadutta/.pyenv/versions/3.10.2/lib/python3.10/site-packages/pydantic/_internal/_generate_schema.py:404: UserWarning: <built-in function any> is not a Python type (it may be an instance of an object), Pydantic will allow any object with no validation since we cannot even enforce that the input is an instance of the given type. To get rid of this error wrap the type with `pydantic.SkipValidation`.
  warn(
======================================================================
ERROR DETECTION API - DEMO
======================================================================

ğŸ¯ Testing on 4 REAL student solutions...
   Questions: Q1-Q4 (Probability, Trigonometry, Algebra, Complex Numbers)
   Student Attempts: Attempt1-4 (Real handwritten solutions)
2025-09-13 18:29:29 - src.models.robust_model_router - INFO - Initialized RobustMultiModelProcessor with openai provider
2025-09-13 18:29:29 - src.models.gemini_processor - INFO - Initialized Gemini client successfully
2025-09-13 18:29:29 - src.models.error_detector - INFO - Initialized ErrorDetector with openai approach

==================================================
ğŸ” ANALYZING SAMPLE 1: real_001
ğŸ“š Topic: Probability
ğŸ“Š Difficulty: hard
ğŸ’¡ Problem: Probability problem about student guessing vs knowing answers
==================================================
ğŸ¯ GROUND TRUTH: âœ… No errors expected

ğŸ¤– API ANALYSIS:
2025-09-13 18:29:29 - src.models.robust_model_router - INFO - Starting robust parallel image processing with openai...
2025-09-13 18:29:41 - src.models.robust_model_router - INFO - Robust parallel processing completed successfully with openai
2025-09-13 18:29:49 - src.models.robust_model_router - INFO - Robust image analysis completed in 20.28s using openai
2025-09-13 18:29:49 - src.models.error_detector - INFO - Robust multi-model error detection completed: has_error=True, confidence=0.950, duration=20.29s using openai
   ğŸ”´ ERROR DETECTED: The student incorrectly calculates P(C âˆ© G) by assuming P(C) = 1 - P(k), which is not correct. P(C) is the total probability of a correct answer, not the complement of P(k).
   ğŸ’¡ Correction: The correct approach is to use Bayes' theorem: P(k|C) = [P(C|k) * P(k)] / P(C). To find P(C), use the law of total probability: P(C) = P(C|k) * P(k) + P(C|G) * P(G).
   ğŸ”§ Hint: Remember that P(C) is the total probability of a correct answer, which includes both the probability of knowing the answer and guessing it correctly. Use the law of total probability to find P(C).
   ğŸ“ Location (Y): 5.0
   â±ï¸  Processing time: 20.29s
   ğŸ Solution complete: False
   ğŸ¨ Contains diagrams: True

ğŸ“Š ACCURACY CHECK:
   âŒ FALSE POSITIVE: API detected error where none exists

ğŸ“ EXTRACTED SOLUTION STEPS:
   1. k: student knows answer
   2. G: student guessed the answer
   3. C: student's answer is correct
   ... and 9 more steps

==================================================
ğŸ” ANALYZING SAMPLE 2: real_002
ğŸ“š Topic: Trigonometry
ğŸ“Š Difficulty: medium
ğŸ’¡ Problem: Find height of tree using angle of elevation
==================================================
ğŸ¯ GROUND TRUTH: âŒ Error Expected
   â””â”€ Arithmetic error in final calculation
   â””â”€ Correction: 47 Ã— tan(35Â°) â‰ˆ 47 Ã— 0.7002 â‰ˆ 32.9, not 33. The closest answer is b) 33

ğŸ¤– API ANALYSIS:
2025-09-13 18:29:49 - src.models.robust_model_router - INFO - Starting robust parallel image processing with openai...
2025-09-13 18:29:57 - src.models.robust_model_router - INFO - Robust parallel processing completed successfully with openai
2025-09-13 18:30:03 - src.models.robust_model_router - INFO - Robust image analysis completed in 13.78s using openai
2025-09-13 18:30:03 - src.models.error_detector - INFO - Robust multi-model error detection completed: has_error=True, confidence=0.950, duration=13.78s using openai
   ğŸ”´ ERROR DETECTED: The student incorrectly calculated the value of tan(35Â°) as 0.5.
   ğŸ’¡ Correction: The correct value of tan(35Â°) is approximately 0.7002. Therefore, the correct calculation should be: h = 47 x 0.7002 â‰ˆ 32.9, which rounds to 33 feet.
   ğŸ”§ Hint: Remember to use a calculator to find the accurate value of trigonometric functions like tan(35Â°).
   â±ï¸  Processing time: 13.78s
   ğŸ Solution complete: True
   ğŸ¨ Contains diagrams: True

ğŸ“Š ACCURACY CHECK:
   âœ… CORRECT: API detected error (matches ground truth)

ğŸ“ EXTRACTED SOLUTION STEPS:
   1. h = ?
   2. tan(35Â°) = h/47
   3. 
   ... and 3 more steps

==================================================
ğŸ” ANALYZING SAMPLE 3: real_003
ğŸ“š Topic: Algebra
ğŸ“Š Difficulty: medium
ğŸ’¡ Problem: Solve 3(x-2)Â² = 75
==================================================
ğŸ¯ GROUND TRUTH: âŒ Error Expected
   â””â”€ Incorrect solution to square root equation
   â””â”€ Correction: From (x-2)Â² = 36, we get x-2 = Â±6, so x = 2Â±6, giving x = 8 or x = -4

ğŸ¤– API ANALYSIS:
2025-09-13 18:30:03 - src.models.robust_model_router - INFO - Starting robust parallel image processing with openai...
2025-09-13 18:30:13 - src.models.robust_model_router - INFO - Robust parallel processing completed successfully with openai
2025-09-13 18:30:19 - src.models.robust_model_router - INFO - Robust image analysis completed in 15.87s using openai
2025-09-13 18:30:19 - src.models.error_detector - INFO - Robust multi-model error detection completed: has_error=True, confidence=0.950, duration=15.87s using openai
   ğŸ”´ ERROR DETECTED: The student incorrectly solved for x by adding 5 instead of 6 to 2.
   ğŸ’¡ Correction: After finding x - 2 = 6, the correct step is x = 2 + 6, which gives x = 8.
   ğŸ”§ Hint: Remember that when you take the square root of both sides, you should consider both the positive and negative roots.
   ğŸ“ Location (Y): 5.0
   â±ï¸  Processing time: 15.87s
   ğŸ Solution complete: False
   ğŸ¨ Contains diagrams: True

ğŸ“Š ACCURACY CHECK:
   âœ… CORRECT: API detected error (matches ground truth)

ğŸ“ EXTRACTED SOLUTION STEPS:
   1. x = ?
   2. 3(x - 2)^2 = 75
   3. (x - 2)^2 = 36
   ... and 4 more steps

==================================================
ğŸ” ANALYZING SAMPLE 4: real_004
ğŸ“š Topic: Complex_Numbers
ğŸ“Š Difficulty: hard
ğŸ’¡ Problem: Complex number conjugate and modulus calculation
==================================================
ğŸ¯ GROUND TRUTH: âŒ Error Expected
   â””â”€ Possible error in complex number calculation
   â””â”€ Correction: Need to verify the expansion and substitution steps carefully

ğŸ¤– API ANALYSIS:
2025-09-13 18:30:19 - src.models.robust_model_router - INFO - Starting robust parallel image processing with openai...
2025-09-13 18:30:32 - src.models.robust_model_router - INFO - Robust parallel processing completed successfully with openai
2025-09-13 18:30:40 - src.models.robust_model_router - INFO - Robust image analysis completed in 21.35s using openai
2025-09-13 18:30:40 - src.models.error_detector - INFO - Robust multi-model error detection completed: has_error=True, confidence=0.950, duration=21.35s using openai
   ğŸ”´ ERROR DETECTED: The student incorrectly expanded (z + 3)(zÌ… + 3) as (2+3)(2Ì… +3) and made errors in calculating |z|Â² and z + zÌ….
   ğŸ’¡ Correction: 1. Correctly expand (z + 3)(zÌ… + 3) using the formula for multiplying complex conjugates: (z + 3)(zÌ… + 3) = (z + 3)(zÌ… + 3) = |z + 3|Â².
2. Calculate |z|Â² correctly: |z|Â² = (1)Â² + (2)Â² = 1 + 4 = 5.
3. Calculate z + zÌ… correctly: z + zÌ… = (1 + 2i) + (1 - 2i) = 2.
4. Substitute and simplify: (z + 3)(zÌ… + 3) = |z + 3|Â² = (|z| + 3)Â² = (âˆš5 + 3)Â².
   ğŸ”§ Hint: Remember that for any complex number z = a + bi, the modulus is |z| = âˆš(aÂ² + bÂ²) and the conjugate is zÌ… = a - bi.
   â±ï¸  Processing time: 21.35s
   ğŸ Solution complete: False
   ğŸ¨ Contains diagrams: False

ğŸ“Š ACCURACY CHECK:
   âœ… CORRECT: API detected error (matches ground truth)

ğŸ“ EXTRACTED SOLUTION STEPS:
   1. 1) expand expression
   2. (2+3)(2Ì… +3) = 2Â² 2Ì… + 3z + 9 = |z|Â² + 3(2+2Ì…)+9
   3. 
   ... and 6 more steps

======================================================================
ğŸ“‹ DEMO SUMMARY
======================================================================
âœ… Demonstrated real-world error detection on:
   â€¢ Probability problems (Bayes' theorem)
   â€¢ Trigonometry problems (angle of elevation)
   â€¢ Algebra problems (quadratic equations)
   â€¢ Complex number arithmetic

ğŸ¯ Key Features Showcased:
   â€¢ Multi-modal analysis (OCR + LLM + VLM)
   â€¢ Step-level error detection
   â€¢ Educational feedback (corrections + hints)
   â€¢ Handwriting processing
   â€¢ Real student work analysis

ğŸš€ Next Steps:
   1. Set up API keys in .env file
   2. Run: make dev (start API server)
   3. Test with: curl -X POST http://localhost:8000/api/v1/detect-error
   4. Run full evaluation: python scripts/run_eval.py
(env) tamaghnadutta@Tamaghnas-MacBook-Air tutor-vision-engine % 